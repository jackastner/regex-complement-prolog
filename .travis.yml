language: python

install:
  - curl -fLo /tmp/pandoc.deb https://github.com/jgm/pandoc/releases/download/2.9.1.1/pandoc-2.9.1.1-1-amd64.deb
  - sudo dpkg -i /tmp/pandoc.deb
  - sudo apt-get install -f
  - rm /tmp/pandoc.deb
  - git clone "https://github.com/entangled/filters.git" /tmp/filters
  - pip install /tmp/filters

script:
  - pandoc -s -t html -f markdown --css=pandoc.css -o index.html regex.md
  - pandoc -t plain --filter pandoc-tangle regex.md

deploy:
  provider: pages
  skip_cleanup: true
  github_token: $GITHUB_TOKEN
  keep_history: true
  on:
    branch: master
